{
   "files":[
      {
         "path":[
            "/",
            "home",
            "dashie",
            "code",
            "rust",
            "stack",
            "auth",
            "build.rs"
         ],
         "content":"fn main() {\n    tonic_build::compile_protos(\"proto/auth.proto\")\n        .unwrap_or_else(|e| panic!(\"Failed to compile protos {:?}\", e));\n}\n",
         "traces":[
            
         ],
         "covered":0,
         "coverable":0
      },
      {
         "path":[
            "/",
            "home",
            "dashie",
            "code",
            "rust",
            "stack",
            "auth",
            "src",
            "main.rs"
         ],
         "content":"pub mod auth {\n    tonic::include_proto!(\"auth\");\n}\n\nuse auth::auth_server::{Auth, AuthServer};\nuse chrono::Utc;\nuse env_logger;\nuse hmac::{Hmac, Mac};\nuse jwt::{claims::Claims, RegisteredClaims, SignWithKey, VerifyWithKey};\nuse log::{debug, error, info, log_enabled, Level};\nuse mongodb::{\n    bson::{self, doc},\n    options::ClientOptions,\n};\nuse scrypt::{\n    password_hash::{rand_core::OsRng, PasswordHash, PasswordHasher, PasswordVerifier, SaltString},\n    Scrypt,\n};\nuse serde::{Deserialize, Serialize};\nuse serde_json::Value;\nuse sha2::Sha256;\nuse std::cell::RefCell;\nuse std::env;\nuse std::sync::Arc;\nuse tonic::{transport::Server, Response, Status};\n\n#[derive(Debug)]\nstruct AuthService {\n    client: Arc<mongodb::Client>,\n}\n\n#[derive(Clone, Deserialize, Serialize)]\nstruct Credentials {\n    #[serde(rename = \"_id\")]\n    id: bson::oid::ObjectId,\n    username: String,\n    password: String,\n    role: Vec<String>,\n}\nuse lazy_static::lazy_static;\n\nlazy_static! {\n    // @TODO - Replace with sig key priv\n    static ref JWT_SIGN_KEY: &'static str = \"someValue1232$214124(aa$asd\";\n}\n\n#[tonic::async_trait]\nimpl Auth for AuthService {\n    async fn register(\n        &self,\n        request: tonic::Request<auth::Credentials>,\n    ) -> Result<Response<auth::Token>, Status> {\n        let db = self.client.default_database().unwrap();\n        let col = db.collection::<Credentials>(\"users\");\n\n        let req_in = request.into_inner().clone();\n        let salt = SaltString::generate(&mut OsRng);\n\n        let result = col\n            .find_one(doc! {\"username\": req_in.username.clone()}, None)\n            .await\n            .unwrap();\n\n        match result {\n            Some(_) => Err(Status::already_exists(\"user already registered\")),\n            None => {\n                let password_hash = Scrypt\n                    .hash_password(req_in.password.as_bytes(), &salt)\n                    .unwrap()\n                    .to_string();\n\n                let mut role = vec![\"user\".to_string()];\n                if req_in.username.clone() == \"dnehrig\" {\n                    role.push(\"admin\".to_string());\n                };\n\n                let res = col\n                    .insert_one(\n                        Credentials {\n                            username: req_in.username.clone(),\n                            password: password_hash.clone(),\n                            role: role.clone(),\n                            id: bson::oid::ObjectId::new(),\n                        },\n                        None,\n                    )\n                    .await\n                    .unwrap();\n\n                let key: Hmac<Sha256> = Hmac::new_from_slice(JWT_SIGN_KEY.as_bytes()).unwrap();\n                let reg = RegisteredClaims::default();\n                let mut claims = Claims::new(reg);\n                let now = Utc::now();\n                let exp = now.clone() + chrono::Duration::days(2);\n                let claim_exp = exp.timestamp() as u64;\n                let id_parse = res.inserted_id.as_object_id().unwrap().to_string();\n                claims.registered.subject = Some(id_parse.clone());\n                claims\n                    .private\n                    .insert(\"name\".into(), Value::String(req_in.username));\n                claims.registered.expiration = Some(claim_exp);\n                claims.private.insert(\n                    \"role\".into(),\n                    Value::Array(\n                        role.clone()\n                            .into_iter()\n                            .map(|e| Value::String(e))\n                            .collect::<Vec<Value>>(),\n                    ),\n                );\n                claims.registered.issuer = Some(\"dnehrig.com\".to_string());\n                claims.registered.issued_at = Some(now.timestamp() as u64);\n\n                let token_str = claims.sign_with_key(&key).unwrap();\n\n                let reply = auth::Token {\n                    auth: token_str.clone(),\n                };\n\n                return Ok(Response::new(reply));\n            }\n        }\n    }\n\n    async fn refresh(\n        &self,\n        request: tonic::Request<auth::Token>,\n    ) -> Result<Response<auth::Token>, Status> {\n        let key: Hmac<Sha256> = Hmac::new_from_slice(JWT_SIGN_KEY.as_bytes()).unwrap();\n        let token = request.into_inner().auth;\n        let sign_res: Result<RefCell<Claims>, _> = token.clone().as_str().verify_with_key(&key);\n        let res = match sign_res {\n            Ok(claims) => {\n                if claims.borrow().registered.expiration.unwrap()\n                    > Utc::now().timestamp().try_into().unwrap()\n                {\n                    let key: Hmac<Sha256> = Hmac::new_from_slice(JWT_SIGN_KEY.as_bytes()).unwrap();\n                    let now = Utc::now();\n                    let exp = now.clone() + chrono::Duration::days(2);\n                    let claim_exp = exp.timestamp() as u64;\n                    claims.borrow_mut().registered.expiration = Some(claim_exp);\n                    claims.borrow_mut().registered.issued_at = Some(now.timestamp() as u64);\n\n                    let token_str = claims.sign_with_key(&key).unwrap();\n                    let reply = auth::Token { auth: token_str };\n                    return Ok(Response::new(reply));\n                }\n\n                return Err(Status::unauthenticated(\"token expired\"));\n            }\n            Err(_) => Err(Status::unauthenticated(\"invalid token\")),\n        };\n        res\n    }\n\n    async fn verify(\n        &self,\n        request: tonic::Request<auth::Token>,\n    ) -> Result<Response<auth::Token>, Status> {\n        let key: Hmac<Sha256> = Hmac::new_from_slice(JWT_SIGN_KEY.as_bytes()).unwrap();\n        let token = request.into_inner().auth;\n        let sign_res: Result<Claims, _> = token.clone().as_str().verify_with_key(&key);\n        let res = match sign_res {\n            Ok(claims) => {\n                if claims.registered.expiration.unwrap()\n                    > Utc::now().timestamp().try_into().unwrap()\n                {\n                    let reply = auth::Token {\n                        auth: token.clone(),\n                    };\n\n                    return Ok(Response::new(reply));\n                }\n\n                return Err(Status::unauthenticated(\"token expired\"));\n            }\n            Err(_) => Err(Status::unauthenticated(\"invalid token\")),\n        };\n        res\n    }\n\n    async fn info(\n        &self,\n        request: tonic::Request<auth::Token>,\n    ) -> Result<Response<auth::AccountInfo>, Status> {\n        let key: Hmac<Sha256> = Hmac::new_from_slice(JWT_SIGN_KEY.as_bytes()).unwrap();\n        let token = request.into_inner().auth;\n        let sign_res: Result<Claims, _> = token.clone().as_str().verify_with_key(&key);\n        let res = match sign_res {\n            Ok(claims) => {\n                let roles = claims\n                    .private\n                    .get(\"role\")\n                    .unwrap()\n                    .as_array()\n                    .unwrap()\n                    .into_iter()\n                    .map(|e| e.as_str().unwrap().to_string())\n                    .collect::<Vec<String>>();\n\n                if claims.registered.expiration.unwrap()\n                    > Utc::now().timestamp().try_into().unwrap()\n                {\n                    let reply = auth::AccountInfo {\n                        id: claims.registered.subject.unwrap().clone(),\n                        username: String::from(\n                            claims.private.get(\"name\").unwrap().as_str().unwrap(),\n                        ),\n                        role: roles.clone(),\n                        auth: token.clone(),\n                    };\n\n                    return Ok(Response::new(reply));\n                }\n\n                return Err(Status::unauthenticated(\"token expired\"));\n            }\n            Err(_) => Err(Status::unauthenticated(\"invalid token\")),\n        };\n        res\n    }\n\n    async fn guest(&self, _: tonic::Request<()>) -> Result<Response<auth::Token>, Status> {\n        let key: Hmac<Sha256> = Hmac::new_from_slice(JWT_SIGN_KEY.as_bytes()).unwrap();\n        let reg_claims = RegisteredClaims::default();\n        let mut claims = Claims::new(reg_claims);\n        let now = Utc::now();\n        let exp = now.clone() + chrono::Duration::days(2);\n        let claim_exp = exp.timestamp() as u64;\n        claims.registered.subject = Some(\"guest\".to_string());\n        claims\n            .private\n            .insert(\"name\".into(), Value::String(\"guest\".to_string()));\n        claims.registered.expiration = Some(claim_exp);\n        claims.private.insert(\n            \"role\".into(),\n            Value::Array(vec![Value::String(\"guest\".to_string())]),\n        );\n        claims.registered.issuer = Some(\"dnehrig.com\".to_string());\n        claims.registered.issued_at = Some(now.timestamp() as u64);\n\n        let token_str = claims.sign_with_key(&key).unwrap();\n        let reply = auth::Token {\n            auth: token_str.clone(),\n        };\n\n        return Ok(Response::new(reply));\n    }\n\n    async fn login(\n        &self,\n        request: tonic::Request<auth::Credentials>,\n    ) -> Result<Response<auth::Token>, Status> {\n        let db = self.client.default_database().unwrap();\n        let col = db.collection::<Credentials>(\"users\");\n\n        let req_in = request.into_inner().clone();\n\n        let res = col\n            .find_one(doc! {\"username\": req_in.username.clone()}, None)\n            .await\n            .unwrap();\n\n        if let Some(creds) = res {\n            let parsed_hash = PasswordHash::new(creds.password.as_str()).unwrap();\n\n            if Scrypt\n                .verify_password(req_in.password.clone().as_bytes(), &parsed_hash)\n                .is_ok()\n            {\n                let key: Hmac<Sha256> = Hmac::new_from_slice(JWT_SIGN_KEY.as_bytes()).unwrap();\n                let reg_claims = RegisteredClaims::default();\n                let mut claims = Claims::new(reg_claims);\n                let now = Utc::now();\n                let exp = now.clone() + chrono::Duration::days(2);\n                let claim_exp = exp.timestamp() as u64;\n                let id_parse = creds.id.to_string();\n                claims.registered.subject = Some(id_parse.clone());\n                claims\n                    .private\n                    .insert(\"name\".into(), Value::String(req_in.username));\n                claims.registered.expiration = Some(claim_exp);\n                claims.private.insert(\n                    \"role\".into(),\n                    Value::Array(\n                        creds\n                            .role\n                            .into_iter()\n                            .map(|e| Value::String(e))\n                            .collect::<Vec<Value>>(),\n                    ),\n                );\n                claims.registered.issuer = Some(\"dnehrig.com\".to_string());\n                claims.registered.issued_at = Some(now.timestamp() as u64);\n\n                let token_str = claims.sign_with_key(&key).unwrap();\n                let reply = auth::Token {\n                    auth: token_str.clone(),\n                };\n\n                return Ok(Response::new(reply));\n            }\n\n            return Err(Status::unauthenticated(\"invalid password\"));\n        }\n\n        return Err(Status::unauthenticated(\"user not found\"));\n    }\n\n    async fn delete(\n        &self,\n        request: tonic::Request<auth::DeleteUser>,\n    ) -> Result<Response<()>, Status> {\n        let db = self.client.default_database().unwrap();\n        let col = db.collection::<Credentials>(\"users\");\n        let data = request.into_inner();\n        let result = col\n            .delete_one(doc! {\"username\": data.username.clone()}, None)\n            .await;\n\n        match result {\n            Ok(_) => Ok(Response::new(())),\n            Err(_) => Err(Status::not_found(\"user not found\")),\n        }\n    }\n\n    async fn health(&self, _request: tonic::Request<()>) -> Result<Response<()>, Status> {\n        Ok(Response::new(()))\n    }\n}\n\n#[tokio::main]\nasync fn main() -> Result<(), Box<dyn std::error::Error>> {\n    env_logger::init();\n    let mongo_port = env::var(\"MONGO_PORT\").unwrap_or_else(|_| \"27017\".to_string());\n    let mongo_host = env::var(\"MONGO_HOST\").unwrap_or_else(|_| \"localhost\".to_string());\n    let addr = \"[::0]:3000\".parse()?;\n\n    let config = tonic_web::config().allow_all_origins();\n    // Parse a connection string into an options struct.\n    let mut client_options = ClientOptions::parse(format!(\n        \"mongodb://{}:{}\",\n        mongo_host.clone(),\n        mongo_port.clone()\n    ))\n    .await?;\n\n    // Manually set an option.\n    client_options.default_database = Some(\"auth\".to_string());\n    client_options.app_name = Some(\"Authentication Service\".to_string());\n\n    // Get a handle to the deployment.\n    let client = mongodb::Client::with_options(client_options)?;\n\n    let greeter = AuthService {\n        client: Arc::new(client),\n    };\n\n    println!(\"Running on {}\", addr);\n    Server::builder()\n        .accept_http1(true)\n        .add_service(config.enable(AuthServer::new(greeter)))\n        .serve(addr)\n        .await?;\n\n    Ok(())\n}\n",
         "traces":[
            {
               "line":49,
               "address":[
                  4323536
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"register"
            },
            {
               "line":53,
               "address":[
                  5121717,
                  5121788
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":54,
               "address":[
                  5122012,
                  5121886
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":56,
               "address":[
                  5122015,
                  5122145
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":57,
               "address":[
                  5122301
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":59,
               "address":[
                  5122881,
                  5122331,
                  5123141,
                  5122675,
                  5122798
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":60,
               "address":[
                  5122698,
                  5123073,
                  5121419,
                  5122345,
                  5121334,
                  5122837
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":64,
               "address":[
                  5123178
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":65,
               "address":[
                  5123243,
                  5123317
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":67,
               "address":[
                  5123587
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":68,
               "address":[
                  5123580,
                  5123210
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":72,
               "address":[
                  5123683,
                  5123762
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":73,
               "address":[
                  5124131,
                  5123886,
                  5123963
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":74,
               "address":[
                  5124069
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":77,
               "address":[
                  5124561,
                  5124141,
                  5125077,
                  5124684,
                  5124761
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":79,
               "address":[
                  5124399
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":80,
               "address":[
                  5124155
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":81,
               "address":[
                  5124189
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":82,
               "address":[
                  5124267
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":83,
               "address":[
                  5124334
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":85,
               "address":[
                  5124525
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":90,
               "address":[
                  5125107,
                  5125175,
                  5125287
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":91,
               "address":[
                  5125325
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":92,
               "address":[
                  5125365,
                  5125450
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":93,
               "address":[
                  5125482
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":94,
               "address":[
                  5125558
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":95,
               "address":[
                  5125626
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":96,
               "address":[
                  5125651
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":97,
               "address":[
                  5125735,
                  5125806
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":98,
               "address":[
                  5126138,
                  5125980
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":100,
               "address":[
                  5125993,
                  5126145
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":101,
               "address":[
                  5126169
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":102,
               "address":[
                  5126498,
                  5126221
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":103,
               "address":[
                  5126234,
                  5126308
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":104,
               "address":[
                  5126458
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":105,
               "address":[
                  5126380,
                  5126316
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":107,
               "address":[
                  5127916,
                  5127904
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"{closure#0}"
            },
            {
               "line":111,
               "address":[
                  5126586
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":112,
               "address":[
                  5126795
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":114,
               "address":[
                  5126864
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":117,
               "address":[
                  5126987
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":120,
               "address":[
                  5127090
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":125,
               "address":[
                  4323792
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"refresh"
            },
            {
               "line":129,
               "address":[
                  5128696,
                  5128501,
                  5128572
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":130,
               "address":[
                  5128726
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":131,
               "address":[
                  5128917,
                  5129004
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":132,
               "address":[
                  5129187
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":133,
               "address":[
                  5129206
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":134,
               "address":[
                  5129597,
                  5129840,
                  5129268,
                  5129681,
                  5129869
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":135,
               "address":[
                  5129858,
                  5129715,
                  5129644
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":137,
               "address":[
                  5130041,
                  5129905
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":138,
               "address":[
                  5130071
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":139,
               "address":[
                  5130106
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":140,
               "address":[
                  5130174
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":141,
               "address":[
                  5130199
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":142,
               "address":[
                  5130389
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":144,
               "address":[
                  5130588
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":145,
               "address":[
                  5130687
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":146,
               "address":[
                  5130751
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":149,
               "address":[
                  5130860,
                  5129875
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":151,
               "address":[
                  5129301
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":153,
               "address":[
                  5129370
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":156,
               "address":[
                  4324048
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"verify"
            },
            {
               "line":160,
               "address":[
                  5131894,
                  5131782,
                  5131717
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":161,
               "address":[
                  5131924
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":162,
               "address":[
                  5132202,
                  5132115
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":163,
               "address":[
                  5132373
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":164,
               "address":[
                  5132392
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":165,
               "address":[
                  5132430,
                  5132850
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":166,
               "address":[
                  5132746
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":169,
               "address":[
                  5132885
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":172,
               "address":[
                  5132944
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":175,
               "address":[
                  5132855,
                  5133060
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":177,
               "address":[
                  5132472
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":179,
               "address":[
                  5132541
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":182,
               "address":[
                  4324304
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"info"
            },
            {
               "line":186,
               "address":[
                  5134080,
                  5133885,
                  5133956
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":187,
               "address":[
                  5134110
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":188,
               "address":[
                  5134301,
                  5134388
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":189,
               "address":[
                  5134571
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":190,
               "address":[
                  5134590
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":191,
               "address":[
                  5134636,
                  5134965
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":198,
               "address":[
                  5136992,
                  5137029
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"{closure#0}"
            },
            {
               "line":201,
               "address":[
                  5135125,
                  5135312
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":202,
               "address":[
                  5135208
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":205,
               "address":[
                  5135456,
                  5135347
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":206,
               "address":[
                  5135703
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":209,
               "address":[
                  5135710
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":210,
               "address":[
                  5135781
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":213,
               "address":[
                  5136045
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":216,
               "address":[
                  5135317,
                  5136261
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":218,
               "address":[
                  5134674
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":220,
               "address":[
                  5134743
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":223,
               "address":[
                  4324577,
                  4324795,
                  4324560
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"guest"
            },
            {
               "line":224,
               "address":[
                  5137656,
                  5137520
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":225,
               "address":[
                  5137694
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":226,
               "address":[
                  5137734,
                  5137819
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":227,
               "address":[
                  5137851
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":228,
               "address":[
                  5137927
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":229,
               "address":[
                  5137995
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":230,
               "address":[
                  5138020
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":231,
               "address":[
                  5138221,
                  5138421
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":233,
               "address":[
                  5138460,
                  5138500,
                  5138234,
                  5138300
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":234,
               "address":[
                  5138535
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":235,
               "address":[
                  5138587,
                  5139021
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":236,
               "address":[
                  5138666,
                  5138600
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":237,
               "address":[
                  5138747,
                  5138684,
                  5138981
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":239,
               "address":[
                  5139119
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":240,
               "address":[
                  5139328
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":242,
               "address":[
                  5139397
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":244,
               "address":[
                  5139520
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":247,
               "address":[
                  5139623
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":250,
               "address":[
                  4324848
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"login"
            },
            {
               "line":254,
               "address":[
                  5140682,
                  5140753
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":255,
               "address":[
                  5140851,
                  5140977
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":257,
               "address":[
                  5140980,
                  5141110
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":259,
               "address":[
                  5141266,
                  5141845,
                  5141762,
                  5141639,
                  5142097
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":260,
               "address":[
                  2920682
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":264,
               "address":[
                  5142135
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":265,
               "address":[
                  5142277,
                  5142532
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":267,
               "address":[
                  5142792,
                  5142694
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":268,
               "address":[
                  5142589
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":271,
               "address":[
                  5142964,
                  5142828
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":272,
               "address":[
                  5143002
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":273,
               "address":[
                  5143127,
                  5143042
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":274,
               "address":[
                  5143159
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":275,
               "address":[
                  5143235
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":276,
               "address":[
                  5143303
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":277,
               "address":[
                  5143328
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":278,
               "address":[
                  5143355,
                  5143426
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":279,
               "address":[
                  5143600,
                  5143758
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":281,
               "address":[
                  5143765,
                  5143613
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":282,
               "address":[
                  5143789
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":283,
               "address":[
                  5144124,
                  5143841
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":284,
               "address":[
                  5143854,
                  5143920
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":285,
               "address":[
                  5144084
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":286,
               "address":[
                  5143928,
                  5144049
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":289,
               "address":[
                  5145980,
                  5145968
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"{closure#0}"
            },
            {
               "line":293,
               "address":[
                  5144212
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":294,
               "address":[
                  5144421
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":296,
               "address":[
                  5144490
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":298,
               "address":[
                  5144615
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":301,
               "address":[
                  5144718
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":304,
               "address":[
                  5142798,
                  5145159
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":307,
               "address":[
                  5142311,
                  5142395
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":310,
               "address":[
                  4325104
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"delete"
            },
            {
               "line":314,
               "address":[
                  5146705,
                  5146643
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":315,
               "address":[
                  5146887,
                  5146779
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":316,
               "address":[
                  5146890
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":317,
               "address":[
                  5147469,
                  5147597,
                  5147096,
                  5147668
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":318,
               "address":[
                  2921450
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":321,
               "address":[
                  5147850
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":322,
               "address":[
                  5148008,
                  5147877
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":323,
               "address":[
                  5147951,
                  5147884
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":327,
               "address":[
                  4325638,
                  4325360,
                  4325375
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"health"
            },
            {
               "line":328,
               "address":[
                  5148823,
                  5148776
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":333,
               "address":[
                  4325677,
                  4325664,
                  4325780
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"main"
            },
            {
               "line":334,
               "address":[
                  5149246
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":335,
               "address":[
                  5154512,
                  5154528,
                  5149565
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"{closure#0}"
            },
            {
               "line":336,
               "address":[
                  5149619,
                  5149702,
                  5154640,
                  5154624
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":"{closure#1}"
            },
            {
               "line":337,
               "address":[
                  5149813,
                  5149721,
                  5149933
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":339,
               "address":[
                  5150029,
                  5149914
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":341,
               "address":[
                  5151348,
                  5151045,
                  5150526,
                  5150801,
                  5151417,
                  5150925,
                  5150287,
                  5150152
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":343,
               "address":[
                  5150060
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":344,
               "address":[
                  5150268
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":346,
               "address":[
                  5151380,
                  5151220
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":349,
               "address":[
                  5151190,
                  5151536
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":350,
               "address":[
                  5151718
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":353,
               "address":[
                  5152075,
                  5151945,
                  5152170
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":356,
               "address":[
                  5152140
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":359,
               "address":[
                  5152486,
                  5152572
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":360,
               "address":[
                  5153124,
                  5152648,
                  5152930,
                  5152861,
                  5153053,
                  5153264,
                  5153383,
                  5153458
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":362,
               "address":[
                  5152821,
                  5152725
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":363,
               "address":[
                  2984602
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":364,
               "address":[
                  2984621
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            },
            {
               "line":366,
               "address":[
                  4325756,
                  4325703,
                  4325848
               ],
               "length":1,
               "stats":{
                  "Line":0
               },
               "fn_name":null
            }
         ],
         "covered":0,
         "coverable":176
      }
   ]
}
